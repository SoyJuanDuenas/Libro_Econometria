{"title":"Matriz de Pesos Espaciales (W)","markdown":{"yaml":{"title":"Matriz de Pesos Espaciales (W)","editor":"visual"},"headingText":"Matriz de Pesos Espaciales","containsRefs":false,"markdown":"\n\n\nUna de las operaciones cruciales en la econometria espacial es expresar formalmente las dependencias espaciales para poder incorporarlas en un modelo, para esto asumimos que las observaciones estan organizadas en datos espaciales los cuales pueden ser puntos en una área regular o irregular, o en su defecto regiones en un mapa.\n\nPara hacer esto vamos a introducir el concepto de Matriz de pesos espaciales o matriz de contigüidad, Considere un sistema S de N unidades espaciales, numeradas i = 1, 2,3,...,n y una variable x observable para cada una de esas unidades espaciales\n\n$$\nW = \\begin{equation}\\begin{bmatrix}w_{11} & w_{12} &  ... & w_{1n}\\\\w_{21} & w_{22} & ... & w_{2n} \\\\ ... & ... & ... & ...\\\\ w_{n1} & w_n2 & ... & w_{nn}\\end{bmatrix}\\end{equation}\n$$\n\ndonde cada elemento de esta matriz de contigüidad esta definido como:\n\n$$\nw_{ij}= \\left\\{ \\begin{array}{lcc} 1 &   si  & j \\in N(i) \\\\ 0 &  si &j \\notin N(i)  \n\\end{array} \\right.\n$$\n\ndonde *N(i)* es el conjunto de vecinos de la localización j, De esta manera la matriz W es una matriz cuadrada no estocastica cuyos elementos *w* reflejan la contigüidad entre los datos espaciales, cada elemento 1 de la matriz correspondera a una contiguidad entre unidades espaciales, por convención un dato espacial no puede ser contigüo consigo mismo lo cual nos resulta en una diagonal principal de ceros.\n\nPara definir la matriz W podemos usar diferentes criterios sobre el conjunto de vecinos de una localización, usualmente recurrimos a criterios de contigüidad fisicos, tal que tenemos 3 tipos de criterios principales:\n\n## Contigüidad Fisica\n\n### Criterio Tipo Torre\n\nLa matriz tipo torre define como vecinos a las observaciones o datos espaciales que comparten algún lado espacial, como solo hablamos de lados podemos imaginarnos los movimientos de la ficha de Ajedres Torre\n\n![](movimiento%20torre.png){fig-align=\"center\"}\n\n### Criterio Tipo Reina\n\nLa matriz tipo reina define como vecinos a las observaciones o datos espaciales que comparten cualquier limite espacial, al igual que en el ejemplo anterior podemos imaginarnos los movimientos de la ficha de Ajedres Reina (Dama)\n\n![](movimiento%20dama.png){fig-align=\"center\"}\n\n### Criterio Tipo Alfil\n\nLa matriz tipo alfil define como vecinos a las observaciones o datos espaciales que comparten limites diagonales, al igual que en el ejemplo anterior podemos imaginarnos los movimientos de la ficha de Ajedres Alfil\n\n![](movimiento%20alfil.png){fig-align=\"center\"}\n\n## Contigüidad en Función de Distancia\n\nEstos tres criterios anteriores usan al usar una contigüidad fisica son facilmente usables en poligonos regulares, sin embargo, la mayoria de poligonos son poligonos irregulares en donde un criterio de contigüidad fisica es un criterio muy restrictivo, es por esto que recurrimos a marcas o rciterios en función de la distancia, esta distancia se puede calcular de diferentes maneras\n\n-   Euclidiana\n\n-   Manhattan\n\n-   Minskowski\n\n### K - vecinos más cercanos (KNN)\n\nEn KNN obtendremos una matriz binaria en la cual generaremos unos centroides en cada poligono espacial, y calcularemos la distancia entre el centroide de nuestro poligono de interés y los centroides de los demas poligonos, los organizaremos y diremos que los k poligonos más cercanos son contigüos\n\n$$\nw_{ij}= \\left\\{ \\begin{array}{lcc} 1 &   si  & \\text{el centroide de j es uno de los k centroides cercanos a i} \\\\ 0 &  si & \\text{en otro caso}  \n\\end{array} \\right.\n$$\n\n### Distancia Basada en Umbrales / radios\n\nEn distancia basada en umbrales o radios obtendremos una matriz binaria en donde a criterio del investigador diremos que hay una contigüidad si la distancia entre centroides esta por debajo de determinado rango.\n\n$$\nw_{ij}= \\left\\{ \\begin{array}{lcc} 1 &   si  & \\text{la distancia entre j e i es menor a n distancia} \\\\ 0 &  si & \\text{en otro caso}  \n\\end{array} \\right.\n$$\n\n### Distancia Inversa\n\nEn la distancia inversa no obtendremos una matriz bianaria sino que nuestro parametro diferente de cero cambiará en función de la distancia inversa, es decir a mayor distancia menor el parametro y viceversa, en este criterio podremos controlar el nivel de descenso de la influencia de la distancia con un parametro alpha, tal que:\n\n$$\nw_{ij}= \\left\\{ \\begin{array}{lcc} \\frac{1}{d^{\\alpha}} &   si  & i \\neq j \\\\ 0 &  si & i = j  \n\\end{array} \\right.\n$$\n\n## Matriz de Pesos Espaciales Estandarizada\n\nAlgunas veces requerimos estandarizar la matriz W, esta estandarización corresponde a la siguiente operación por filas:\n\n$$\nw^{*}_{ij} = \\frac{w_{ij}}{\\sum w_{ij}}\n$$ donde\n\n$$w^{*}_{ij} \\in W^{*}$$ Es decir cada elemento estandarizado de la matriz de pesos espaciales corresponde a la división entre 0 o 1 y la sumatoria de elementos con relación de esa fila, lo cual seria el porcentaje del total de relaciones de cada fila\n\nEsta estandarización puede ser muy útil en algunas instancias. por ejemplo, usando la matriz de pesos espaciales estandarizada podemos operador de retardo espacial.\n\n## Operador de Retardo Espacial\n\nUno de los objetivos del uso de matrices de pesos espaciales en la especificación de un modelo econometrico espacial es poder relatar una variable en un punto en el espacio de las observaciones para esa variable entre otras unidades espaciales en el sistema, esto en el contexto de series de tiempo se le denomina como operador de retardo de la forma:\n\n$$\ny_{t-k} = L^{k}y\n$$\n\nEn el espacio no tenemos una dimensión temporal sino una dimensión geografica tal que en función del tipo de criterio que elijamos obtendremos un retardo espacacial diferente, para calcular el retardo espacial usamos:\n\n$$\n\\rho = W^{*}Y\n$$\n\nEn una matriz de tipo reina obtendremos un rezago parecido al siguiente:\n\n![](Retardo%20Espacial%20Reina.png){fig-align=\"center\" width=\"285\"}\n\nMientras que en una matriz de tipo torre tendremos un rezago parecido al siguiente:\n\n![](Retardo%20Espacial%20Torre.png){fig-align=\"center\" width=\"280\"}\n\n## PENDIENTE\n\na esta pagina falta añadirle codigo en R y un ejemplo (puede ser el del parcial)\n\n## Bibliografia\n\nAnselin, L. (1988). Spatial econometrics: methods and models. Vol. 4. Springer Science & Business Media.\n\nArbia, G. (2014). *A Primer for Spatial Econometrics: With Applications in R*. Palgrave Macmillan.\n\n\\\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"w.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.189","editor":"visual","theme":"cosmo","title":"Matriz de Pesos Espaciales (W)"},"extensions":{"book":{"multiFile":true}}}}}